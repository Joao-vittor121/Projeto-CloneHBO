<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Jogo da Cobrinha</title>
    <link rel="stylesheet" href="style.css">
    <style>
        /* Estilização para o Jogo da Cobrinha */
        body {
            font-family: 'Arial', sans-serif;
            background-color: #121212;
            color: white;
            margin: 0;
            padding: 0;
            text-align: center;
        }

        #gameContainer {
            margin-top: 50px;
        }

        h2 {
            font-size: 32px;
            color: #f2f2f2;
            margin-bottom: 10px;
        }

        #score, #title, #timer {
            font-size: 20px;
            margin: 5px 0;
            color: #f2f2f2;
        }

        #countdown {
            font-size: 24px;
            margin-bottom: 10px;
            color: #f9c74f;
        }

        canvas {
            border: 3px solid #333;
            background-color: #2b2b2b;
            display: block;
            margin: 0 auto;
            border-radius: 5px;
        }

        /* Estilo para os botões */
        button {
            padding: 10px 20px;
            background-color: #f9c74f;
            color: #333;
            font-size: 18px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s;
            margin-top: 20px;
            width: 200px;
            margin-bottom: 15px;
        }

        button:hover {
            background-color: #f2a900;
        }

        #restartButton, #backButton {
            display: none;
            width: 200px;
            margin: 10px auto;
        }

        /* Centralizando os botões */
        .button-container {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            margin-top: 20px;
        }

        /* Estilo do Joystick */
        .joystick-container {
            position: fixed;
            bottom: 50px;
            left: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .joystick-button {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background-color: #f9c74f;
            margin: 5px;
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            transition: background-color 0.3s;
        }

        .joystick-button:hover {
            background-color: #f2a900;
        }

        /* Controles de direção */
        .joystick-up, .joystick-down, .joystick-left, .joystick-right {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background-color: #f9c74f;
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            transition: background-color 0.3s;
        }

        .joystick-up:hover, .joystick-down:hover, .joystick-left:hover, .joystick-right:hover {
            background-color: #f2a900;
        }

        /* Usando caracteres para representar as setas */
        .joystick-up::after {
            content: "↑";
            font-size: 24px;
        }

        .joystick-left::after {
            content: "←";
            font-size: 24px;
        }

        .joystick-right::after {
            content: "→";
            font-size: 24px;
        }

        .joystick-down::after {
            content: "↓";
            font-size: 24px;
        }

        /* Responsividade */
        @media screen and (max-width: 600px) {
            canvas {
                width: 100%;
                height: auto;
            }

            button {
                width: 80%;
            }

            .joystick-container {
                left: 10px;
                bottom: 10px;
            }

            .joystick-button {
                width: 40px;
                height: 40px;
            }

            h2 {
                font-size: 28px;
            }

            #score, #title, #timer {
                font-size: 18px;
            }

            #countdown {
                font-size: 22px;
            }
        }
    </style>
</head>
<body>
    <p>Clique no botão de voltar, logo após perder a partida para voltar à tela de login.</p>
    <div id="gameContainer">
        <h2>Jogo da Cobrinha</h2>
        <div id="countdown">Começando em: 3</div>
        <div id="score">Pontuação: 0</div>
        <div id="title"></div>
        <div id="timer">Tempo: 0</div>
        <canvas id="gameCanvas" width="500" height="500"></canvas>

        <!-- Container dos Botões -->
        <div class="button-container">
            <button id="restartButton" onclick="reiniciarJogo()">Reiniciar Jogo</button>
            <button id="backButton" onclick="window.location.href='../pages/entrar.html'">Voltar</button>
        </div>
    </div>

    <!-- Joystick para dispositivos móveis -->
    <div class="joystick-container">
        <div class="joystick-button joystick-up" onclick="moverCobrinha('up')"></div>
        <div class="joystick-button joystick-left" onclick="moverCobrinha('left')"></div>
        <div class="joystick-button joystick-right" onclick="moverCobrinha('right')"></div>
        <div class="joystick-button joystick-down" onclick="moverCobrinha('down')"></div>
    </div>

    <script>
        var dx = 10, dy = 0;  // Direção da cobrinha
        var snake, food, score, speed, timeElapsed, isGameOver, startTime, gameInterval;
        var canvas = document.getElementById("gameCanvas");
        var ctx = canvas.getContext("2d");

        function inicializarJogo() {
            snake = [{x: 150, y: 150}];
            food = {x: 200, y: 200};
            score = 0;
            speed = 80;  // Velocidade inicial
            timeElapsed = 0;
            dx = 10;
            dy = 0;
            isGameOver = false;
            startTime = Date.now();

            document.getElementById("score").textContent = "Pontuação: " + score;
            document.getElementById("timer").textContent = "Tempo: 0";
            document.getElementById("countdown").style.display = "block";
            document.getElementById("title").textContent = "";

            document.getElementById("restartButton").style.display = "none";
            document.getElementById("backButton").style.display = "none";
        }

        function iniciarContagemRegressiva() {
            var countdownElement = document.getElementById("countdown");
            var countdownValue = 3;
            countdownElement.textContent = "Começando em: " + countdownValue;

            var countdownInterval = setInterval(function() {
                countdownValue--;
                countdownElement.textContent = "Começando em: " + countdownValue;

                if (countdownValue === 0) {
                    clearInterval(countdownInterval);
                    countdownElement.style.display = "none";
                    iniciarJogo();
                }
            }, 1000);
        }

        function iniciarJogo() {
            gameInterval = setInterval(gameLoop, speed);
        }

        function controleTeclado(event) {
            if (event.key === "ArrowUp" || event.key === "w") {
                if (dy === 0) { dx = 0; dy = -10; }
            }
            if (event.key === "ArrowDown" || event.key === "s") {
                if (dy === 0) { dx = 0; dy = 10; }
            }
            if (event.key === "ArrowLeft" || event.key === "a") {
                if (dx === 0) { dx = -10; dy = 0; }
            }
            if (event.key === "ArrowRight" || event.key === "d") {
                if (dx === 0) { dx = 10; dy = 0; }
            }
        }

        function gameLoop() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);

            // Movimentar a cobrinha
            ctx.fillStyle = "#00ff00";
            var head = {x: snake[0].x + dx, y: snake[0].y + dy};
            snake.unshift(head);

            // Verificar se a cobrinha comeu a comida
            if (head.x === food.x && head.y === food.y) {
                score += 10;
                updateScore();

                food.x = Math.floor(Math.random() * canvas.width / 10) * 10;
                food.y = Math.floor(Math.random() * canvas.height / 10) * 10;

                // Aumentar a velocidade a cada 35 pontos
                if (score % 35 === 0) {
                    speed -= 5; // Aumentar a velocidade
                    clearInterval(gameInterval);
                    gameInterval = setInterval(gameLoop, speed); // Reiniciar o jogo com a nova velocidade
                }
            } else {
                snake.pop();
            }

            // Desenhar a cobrinha
            snake.forEach(function(segment) {
                ctx.fillRect(segment.x, segment.y, 10, 10);
            });

            // Desenhar a comida
            ctx.fillStyle = "#f00"; // Cor da comida
            ctx.fillRect(food.x, food.y, 10, 10);

            // Verificar colisão com as bordas
            if (head.x < 0 || head.x >= canvas.width || head.y < 0 || head.y >= canvas.height || colisaoComCobrinha(head)) {
                gameOver();
            }

            updateTime();
            setTitle(score);
        }

        function setTitle(score) {
            let title = "";
            let titleColor = "";

            if (score >= 15000) {
                title = "Deus da Cobrinha!";
                titleColor = "#ff4500";  // Laranja avermelhado
            } else if (score >= 12000) {
                title = "Lendário!";
                titleColor = "#ffd700";  // Dourado
            } else if (score >= 8000) {
                title = "Campeão!";
                titleColor = "#00ff00";  // Verde
            } else if (score >= 5000) {
                title = "Profissional!";
                titleColor = "#32cd32";  // Verde limão
            } else if (score >= 3000) {
                title = "Experiente!";
                titleColor = "#87ceeb";  // Azul claro
            } else if (score >= 1000) {
                title = "Intermediário!";
                titleColor = "#ff6347";  // Tomate
            } else if (score >= 500) {
                title = "Novato!";
                titleColor = "#ff69b4";  // Rosa quente
            } else {
                title = "Iniciante!";
                titleColor = "#f9c74f";  // Amarelo
            }

            if (score >= 6200 && timeElapsed <= 420) {
                title = "Título Secreto Desbloqueado!";
                titleColor = "#8a2be2";  // Azul violeta
            }

            document.getElementById("title").textContent = title;
            document.getElementById("title").style.color = titleColor;
        }

        function colisaoComCobrinha(head) {
            for (var i = 1; i < snake.length; i++) {
                if (snake[i].x === head.x && snake[i].y === head.y) {
                    return true;
                }
            }
            return false;
        }

        function updateScore() {
            document.getElementById("score").textContent = "Pontuação: " + score;
        }

        function updateTime() {
            timeElapsed = Math.floor((Date.now() - startTime) / 1000);
            document.getElementById("timer").textContent = "Tempo: " + timeElapsed;
        }

        function reiniciarJogo() {
            clearInterval(gameInterval);
            inicializarJogo();
            iniciarContagemRegressiva();
        }

        function gameOver() {
            clearInterval(gameInterval);
            document.getElementById("restartButton").style.display = "block";
            document.getElementById("backButton").style.display = "block";
            isGameOver = true;
        }

        function moverCobrinha(direcao) {
            if (direcao === "up" && dy === 0) { dx = 0; dy = -10; }
            if (direcao === "down" && dy === 0) { dx = 0; dy = 10; }
            if (direcao === "left" && dx === 0) { dx = -10; dy = 0; }
            if (direcao === "right" && dx === 0) { dx = 10; dy = 0; }
        }

        // Iniciar o jogo
        inicializarJogo();
        iniciarContagemRegressiva();

        // Adicionar event listener para teclados
        window.addEventListener("keydown", controleTeclado);
    </script>
</body>
</html>
